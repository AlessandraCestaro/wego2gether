<!-- show.html.erb -->

<!-- if all users have voted || if trip.deadline_date < today
display FINAL DESTINATION + MEMBERS-->

<div class="container">
  <div class="row">
    <div class="col-sm-12 col-md-4">
      <% if ((@trip.invited_users_all.size - @trip.invited_users_declined.size) == @trip.users_voted.size) || (@trip.deadline_date < Date.today) %>

          <h1 id="showTripsTitle">The winner is...</h1>
        <!-- At the moment if there is a "parimerito", it shows a random result. To fix show page when trip expired and no one has voted-->

        <div class="banner" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url('<%= image_path(@trip.winning_destination.first.picture_mobile, class: "destination-vote")%>')">
          <div class="banner-content">
            <h1 class="destination-name-pic"><%= @trip.winning_destination.first.city.split(",").first.capitalize%></h1>
            <h2 class="destination-name-pic"><%= @trip.winning_destination.first.city.split(",").last.capitalize%></h2>
          </div>
        </div>

          <div class="block">
              <% @accepted.each do |user| %>
            <div>
              <p class="text-center"> <%= user.first_name %> </p>
              <%= image_tag("profileicon.svg", class:"avatar-large")%>
            </div>
          <% end %>
          </div>


        <% else %>
        <!-- ELSE: If not all users have voted and trip has not expired -->
          <h1 id="showTripsTitle"> <%= "#{@trip.name.capitalize}: trip status" %> </h1>

            <p style="font-size: 16px">Participating and have voted for destination!</p>
            <div class="block">
              <% @voted.each do |user| %>
              <div>
                <p class="text-center"> <%= user.first_name %> </p>
                <%= image_tag("profileicon.svg", class:"avatar-large")%>
              </div>
              <% end %>
            </div>

          <p style="font-size: 16px">Participating but didn't vote destination yet...</p>
          <div class="block">
            <% @novoted.each do |user| %>
            <div>
              <p class="text-center"> <%= user.first_name %> </p>
              <%= image_tag("profileicon.svg")%>
            </div>
            <% end %>
          </div>

          <p style="font-size: 16px">Pending invitees</p>
          <div class="block">
            <% @pending.each do |user| %>
            <div>
              <p class="text-center"> <%= user.first_name %> </p>
              <div>
              <%= image_tag("profileicon.svg", class:"avatar-large") %>
              </div>
            </div>
            <% end %>
          </div>

          <p style="font-size: 16px">Won't make it...</p>
          <div class="block">
            <% @declined.each do |user| %>
            <div class="divAvatar">
            <p class="text-center"> <%= user.first_name %> </p>
              <br>
              <%= image_tag("profileicon.svg")%>
            </div>
            <% end %>
          </div>

      <% end %>
    </div>
  </div>
</div>
